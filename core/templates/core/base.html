<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>{% block page_title %}ERP Padaria{% endblock %}</title>

    <!-- Bootstrap 5.3 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&family=Caveat:wght@700&display=swap"
      rel="stylesheet"
    />

    <!-- Custom Styles -->
    <style>
  :root {
    --primary-color: #bf0200;  /* Vermelho suave da logo */
    --secondary-color: #e0c993; /* Bege claro */
    --background-light: #edf0d1; /* Fundo claro */
    --background-secondary: #f2c04; /* Fundo secundário */
  }

  body {
    font-family: "Raleway", sans-serif;
    background-color: var(--background-light);
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .sidebar {
    background-color: var(--secondary-color);
    width: 250px;
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    padding: 20px;
    transition: all 0.3s ease;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    overflow-y: auto;
  }

  .sidebar .logo {
    display: flex;
    align-items: center;
    margin-bottom: 30px;
    justify-content: center;
  }

  .sidebar .logo i {
    font-size: 2rem;
    color: var(--primary-color);
  }

  .sidebar .logo h5 {
    margin: 0 10px;
    font-family: "Raleway", sans-serif;
    font-size: 1.8rem;
    color: var(--primary-color);
  }

  .sidebar .nav-link {
    color: #2e0000;
    border-radius: 8px;
    padding: 10px 15px;
    margin: 5px 0;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
  }

  .sidebar .nav-link i {
    margin-right: 10px;
  }

  .sidebar .nav-link:hover,
  .sidebar .nav-link:focus {
    background-color: rgba(224, 201, 147, 0.5);
    transform: translateX(5px);
  }

  .content-wrapper {
    margin-left: 250px;
    padding: 20px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    width: 100%;
    padding-right: 0;
    background-color: var(--background-light);
  }

  .topbar {
    background-color: #fff;
    border-radius: 15px;
    padding: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
  }

  .topbar h2 {
    font-family: "Raleway", sans-serif; 
    font-size: 2rem;
    color: var(--primary-color);
    margin: 0;
  }

  .user-section {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .user-section span {
    color: #555;
    font-weight: 500;
  }

  .btn-danger {
    background-color: var(--primary-color);
    border: none;
    border-radius: 8px;
    padding: 8px 15px;
    transition: all 0.3s ease;
    color: #fff;
  }

  .btn-danger:hover,
  .btn-danger:focus {
    background-color: #a00200;
    transform: translateY(-2px);
  }

  .alert-fixed-top {
    position: fixed;
    top: 90px;
    right: 20px;
    z-index: 1000;
    font-family: "Raleway", sans-serif;
  }

  .alert-fixed-top .badge {
    background-color: var(--primary-color);
    color: #fff;
    padding: 8px 12px;
    border-radius: 10px;
    text-decoration: none;
    transition: all 0.3s ease;
    font-size: 0.9rem;
  }

  .alert-fixed-top .badge:hover,
  .alert-fixed-top .badge:focus {
    background-color: #a00200;
    transform: translateY(-2px);
  }

  .content {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  .sidebar-toggle {
    display: none;
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1100;
    background-color: var(--primary-color);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 8px;
    cursor: pointer;
  }

  @media (min-width: 1600px) {
    .sidebar {
      width: 300px;
    }
    .content-wrapper {
      margin-left: 300px;
    }
  }

  @media (max-width: 1200px) {
    .content-wrapper {
      padding: 15px;
    }
  }

  @media (max-width: 992px) {
    .topbar h2 {
      font-size: 1.8rem;
    }
    .user-section .btn-danger {
      padding: 6px 12px;
    }
  }

  @media (max-width: 768px) {
    .sidebar {
      width: 70px;
      padding: 15px;
    }
    .sidebar .logo h5,
    .sidebar .nav-link span {
      display: none;
    }
    .sidebar .nav-link i {
      margin: 0;
      font-size: 1.5rem;
    }
    .sidebar .logo i {
      font-size: 1.8rem;
    }
    .content-wrapper {
      margin-left: 70px;
    }
    .topbar {
      padding: 10px;
    }
    .topbar h2 {
      font-size: 1.5rem;
    }
    .alert-fixed-top {
      top: 70px;
      right: 10px;
    }
    .alert-fixed-top .badge {
      padding: 6px 10px;
      font-size: 0.8rem;
    }
  }

  @media (max-width: 576px) {
    .topbar {
      flex-direction: column;
      gap: 10px;
      text-align: center;
    }
    .user-section {
      width: 100%;
      justify-content: center;
    }
    .user-section span {
      display: block;
      margin-bottom: 5px;
    }
    .content-wrapper {
      padding: 10px;
    }
    .alert-fixed-top {
      top: 60px;
    }
  }

  @media (max-width: 480px) {
    .sidebar {
      transform: translateX(-100%);
      visibility: hidden;
      transition: all 0.3s ease;
    }
    .sidebar.active {
      transform: translateX(0);
      visibility: visible;
    }
    .content-wrapper {
      margin-left: 0;
    }
    .sidebar-toggle {
      display: block;
    }
    .topbar h2 {
      font-size: 1.3rem;
    }
    .user-section .btn-danger {
      font-size: 0.85rem;
      padding: 4px 8px;
    }
    .alert-fixed-top {
      top: 50px;
      right: 5px;
    }
    .alert-fixed-top .badge {
      padding: 4px 8px;
      font-size: 0.7rem;
    }
  }

  /* Heart design */
  .heart {
    position: relative;
    width: 20px;
    height: 20px;
    background-color: #e0c993;
    transform: rotate(-45deg);
    margin: 0 10px;
  }
  .heart:before,
  .heart:after {
    content: "";
    position: absolute;
    width: 20px;
    height: 20px;
    background-color: #e0c993;
    border-radius: 50%;
  }
  .heart:before {
    top: -10px;
    left: 0;
  }
  .heart:after {
    left: 10px;
    top: 0;
  }
  .sidebar .logo .heart {
    margin-left: 5px;
  }
</style>
  </head>
  <body>
    <div class="d-flex h-100">
      <button class="sidebar-toggle" aria-label="Abrir menu de navegação">
        <i class="bi bi-list"></i>
      </button>

      <div class="sidebar">
        <div class="logo">
          <i class="bi bi-shop" aria-hidden="true"></i>
          <h5>ERP Padaria<span class="heart"></span></h5>
        </div>
        <hr style="border-color: rgba(46, 0, 0, 0.3)" />
        <ul class="nav flex-column">
          <li class="nav-item">
            <a href="{% url 'core:dashboard' %}" class="nav-link" aria-label="Dashboard">
              <i class="bi bi-house-door" aria-hidden="true"></i>
              <span>Dashboard</span>
            </a>
          </li>
<li class="nav-item">
  <a
    href="{% url 'core:dashboard_estoques' %}"
    class="nav-link"
    aria-label="Estoques"
  >
    <i class="bi bi-boxes" aria-hidden="true"></i> <!-- Ícone ajustado para estoques -->
    <span>Estoques</span>
  </a>
</li>
          <li class="nav-item">
            <a href="{% url 'receitas:listar_receitas' %}" class="nav-link" aria-label="Receitas">
              <i class="bi bi-journal-text" aria-hidden="true"></i>
              <span>Receitas</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'fornadas:lista_fornadas' %}" class="nav-link" aria-label="Fornadas">
              <i class="bi bi-fire" aria-hidden="true"></i>
              <span>Fornadas</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'produtos:lista_produtos' %}" class="nav-link" aria-label="Produtos">
              <i class="bi bi-box-seam" aria-hidden="true"></i>
              <span>Produtos</span>
            </a>
          </li>
          {% if user.is_authenticated and user.perfil == 'GESTOR' %}
          <li class="nav-item">
            <a href="{% url 'core:listar_usuarios' %}" class="nav-link" aria-label="Usuários">
              <i class="bi bi-person-gear" aria-hidden="true"></i>
              <span>Usuários</span>
            </a>
          </li>
          {% endif %}
          <li class="nav-item">
            <a
              href="{% url 'financeiro:dashboard_financeiro' %}"
              class="nav-link"
              aria-label="Financeiro"
            >
              <i class="bi bi-cash-coin" aria-hidden="true"></i>
              <span>Financeiro</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'clientes:listar_clientes' %}" class="nav-link" aria-label="Lista de Clientes">
              <i class="bi bi-people" aria-hidden="true"></i>
              <span>Lista de Clientes</span>
            </a>
          </li>
        </ul>
      </div>

      <div class="content-wrapper">
        <div class="topbar">
          <h2>{% block content_title %}Dashboard{% endblock %}</h2>
          {% if user.is_authenticated %}
          <div class="user-section">
            <span>Olá, {{ user.username }}</span>
            <form action="{% url 'core:logout' %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger" aria-label="Sair">Sair</button>
            </form>
          </div>
          {% endif %}
        </div>

        <div class="content">{% block content %}{% endblock %}</div>
      </div>

      {% if ingredientes_alerta_count > 0 %}
  <div class="alert-fixed-top">
    <a
      href="{% url 'ingredientes:gerar_lista_compras' %}"
      class="badge"
      aria-label="{{ ingredientes_alerta_count }} alerta(s) de ingredientes"
    >
      <i class="bi bi-exclamation-triangle" aria-hidden="true"></i> 
      {{ ingredientes_alerta_count }} 
      {% if ingredientes_alerta_count == 1 %}
        Alerta
      {% else %}
        Alertas
      {% endif %}
    </a>
  </div>
{% endif %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      document.querySelector('.sidebar-toggle').addEventListener('click', function () {
        document.querySelector('.sidebar').classList.toggle('active');
      });
    </script>
    {% block extra_scripts %}{% endblock %}
  </body>
</html>